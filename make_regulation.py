from fpdf import FPDF
from fpdf.enums import XPos, YPos 

class PDF(FPDF):
    def header(self):
        self.set_font('Malgun', size=10) 
        # 헤더 제목
        self.cell(0, 10, '군 부서별 담당업무 예규', border=0, new_x=XPos.LMARGIN, new_y=YPos.NEXT, align='C')

    def chapter_title(self, num, label):
        self.set_font('Malgun', size=12)
        self.set_fill_color(200, 220, 255)
        
        # 'Chapter 1 : 인사부' 형식으로 출력
        title_text = f'Chapter {num} : {label}'
        
        self.cell(0, 10, title_text, border=0, new_x=XPos.LMARGIN, new_y=YPos.NEXT, align='L', fill=True)
        self.ln(4)

    def chapter_body(self, body):
        self.set_font('Malgun', size=11)
        self.multi_cell(0, 10, body)
        self.ln()

# --- 메인 실행 코드 ---

# 1. PDF 객체 생성 및 폰트 등록
pdf = PDF()
pdf.add_font('Malgun', '', r'C:\Windows\Fonts\malgun.ttf')
pdf.set_font('Malgun', size=11)

# 2. 부서별 데이터 (딕셔너리)
departments = {
    "인사부": "주요 업무:\n- 장병 인사 및 배치 관리\n- 전역·입대·전출·전입 관리\n- 인사기록 및 성적 관리\n- 인사 평가 및 승진, 포상, 징계 관리\n- 교육·훈련 참여 현황 관리\n- 인력 수급 및 인사 통계 분석\n- 장병 복지 관련 상담 및 지원\n- 장병 성인지교육 담당\n\n세부 예규:\n1. 모든 장병의 인사 기록은 중앙 인사 시스템에 등록하고, 변경 시 즉시 갱신한다.\n2. 전입·전출 계획은 분기별로 작성하여 상급부대에 보고한다.\n3. 포상 및 징계 관련 사항은 관련 규정에 따라 문서화하고 보관한다.",

    "군수부": "주요 업무:\n- 군수품 및 장비 조달\n- 물자 관리 및 배급\n- 차량·장비 유지보수 관리\n- 군수 계획 수립 및 집행\n- 긴급 보급 및 예비 물자 관리\n- 군수 관련 계약 및 비용 검토\n- 창고 및 물류 시스템 운영\n- 군수 관련 안전 점검 및 사고 예방\n\n세부 예규:\n1. 모든 물자는 재고 시스템에 등록하고, 정기 점검을 실시한다.\n2. 긴급 물자 요청은 즉시 상급부대와 협의하여 조치한다.\n3. 장비 정비 기록은 정기적으로 검토하여 이상 유무를 확인한다.",

    "정보작전부": "주요 업무:\n- 부대 운영 기획 및 관리\n- 부대 교육훈련 담당\n- 군 부대, 장비 편제업무\n- 정보 수집·분석 및 제공\n- 작전 계획 지원\n- 적·아군 상황 파악\n- 정보작전 훈련 계획 수립\n- 위협 분석 및 대응 전략 수립\n- 정보 공유 및 협조 체계 관리\n- 정보 보안 및 기밀 유지\n\n세부 예규:\n1. 모든 정보는 보안 규정에 따라 취급하고, 외부 유출 금지.\n2. 분석 보고서는 정기적으로 상급부대와 공유하며, 보안 등급에 따라 분류한다.\n3. 작전 지원 자료는 훈련·작전 전 반드시 최신화한다.",

    "기획참모부": "주요 업무:\n- 무기체계 소요제기 및 사업관리\n- 재정관리 및 계약업무\n- 예산 편성 및 집행\n- 부대 편성 및 재편 계획 수립\n- 연간·분기별 작전 계획 지원\n- 부대 내부 정책 및 규정 제정 지원\n- 훈련 일정 조정 및 평가 지원\n- 장비 및 시설 배치 계획\n- 전략적 자원 계획 및 분석\n\n세부 예규:\n1. 예산 집행 내역은 매월 검토하며, 초과 지출 시 사유 보고.\n2. 부대 편성 변경은 상급부대 승인을 거쳐 시행.\n3. 작전 계획 지원 문서는 기밀로 분류하고, 필요시 최소 인원만 접근 가능하도록 관리.",

    "정보화부": "주요 업무:\n- 군 내부 정보시스템 관리\n- 네트워크 및 보안 관리\n- 정보화 장비 도입 및 유지보수\n- 정보화 정책 수립 및 교육\n- 소프트웨어 및 하드웨어 업그레이드 계획\n- 데이터 백업 및 복구 관리\n- 정보화 관련 교육 및 훈련 실시\n- 사이버작전센터운용 및 사이버방호관련 업무\n- 사이버 인력 관리\n- 시스템 장애 대응 및 문제 해결\n\n세부 예규:\n1. 모든 정보시스템 접속은 인증 절차를 거친 후 수행.\n2. 정기 백업 및 사이버 보안 점검을 월 1회 이상 실시.\n3. 정보화 장비 구입은 승인 절차 후 배치 및 등록.",

    "의무실": "주요 업무:\n- 장병 건강 관리\n- 의무기록 관리\n- 부대 내 응급처치 및 질병 예방\n- 의료 지원 및 훈련\n- 예방접종 계획 및 관리\n- 긴급 의료 대응 계획 수립\n- 의료 장비 및 약품 관리\n\n세부 예규:\n1. 모든 진료 기록은 비밀로 관리하며, 지정 시스템에 등록.\n2. 예방접종 및 건강검진 일정은 연간 계획 수립 후 시행.\n3. 응급 상황 발생 시, 즉시 대응 체계를 가동하고 보고.",

    "법무실": "주요 업무:\n- 법률 자문 및 소송 지원\n- 군 내부 규정 검토 및 제정 지원\n- 징계 관련 법률 검토\n- 법령 및 규정 교육\n- 계약서 검토 및 법적 위험 분석\n- 군사 법규 관련 상담 제공\n- 법적 분쟁 발생 시 대응 지원\n- 규정 위반 사례 조사 및 보고\n\n세부 예규:\n1. 법률 검토 자료는 공식 문서로 작성하여 부대 기록에 보관.\n2. 징계 관련 사안은 법적 절차에 따라 처리.\n3. 정기 법령 교육은 연 2회 이상 실시.",

    "군사경찰실": "주요 업무:\n- 부대 질서 유지 및 보안\n- 범죄 예방 및 조사\n- 군사법 집행 지원\n- 교통 관리 및 경계 임무\n- 출입 통제 및 신원 확인\n- 군 내부 안전 점검\n- 사고 조사 및 보고\n- 군사법 관련 교육\n\n세부 예규:\n1. 모든 범죄 및 사고는 보고 후 즉시 기록.\n2. 부대 내 경계 근무는 교대 근무표에 따라 실시.\n3. 교통사고 발생 시 현장 기록과 보고를 필수로 수행.",

    "공병실": "주요 업무:\n- 공병 장비 운영 및 유지\n- 시설 건설 및 보수\n- 장애물 설치 및 제거\n- 지형 분석 및 공병 지원\n- 다리 및 도로 건설 지원\n- 폭발물 처리 및 안전 관리\n- 공병 관련 훈련 및 교육\n- 재난 복구 및 지원\n\n세부 예규:\n1. 모든 시설물 점검은 월 1회 이상 실시.\n2. 공병 장비 사용 후 점검 및 정비를 기록.\n3. 장애물 설치 계획은 작전 계획에 따라 시행.",

    "동원부": "주요 업무:\n- 전시 동원 계획 수립\n- 예비군·민방위 관리\n- 자원 동원 및 배치\n- 동원 훈련 계획 수립\n- 인력 및 장비 동원 계획 작성\n- 비상 대응 훈련 관리\n- 동원 통계 관리 및 보고\n- 재난·위기 상황 대비 계획\n\n세부 예규:\n1. 동원 계획은 매년 갱신하고, 상급부대에 보고.\n2. 예비군 및 민방위 인력 명단은 최신 상태로 유지.\n3. 동원 훈련 후 보고서를 작성하여 기록.",

    "군종실": "주요 업무:\n- 장병 종교 지원\n- 종교 상담 및 심리 지원\n- 종교 시설 관리 및 운영\n- 군종 관련 교육 및 프로그램 운영\n- 종교 활동 참여 장려 및 관리\n- 장병 정신적 지원 프로그램 기획\n- 종교 행사 관리\n- 종교 관련 자료 관리 및 보고\n\n세부 예규:\n1. 모든 종교 활동은 자율 참여 원칙 준수.\n2. 종교 상담 내용은 비밀로 관리.\n3. 종교 행사 및 프로그램 계획은 부대 승인 후 시행.",

    "공보정훈실": "주요 업무:\n- 공보업무\n- 장병 정신교육 담당\n- 언론통제 및 대응\n- 미디어 컨텐츠 제작\n- 육군 홍보물 제작.",

    "안전단": "주요 업무:\n- 부대 안전관련 업무\n- 안전 관련 제도 담당\n- 장병 정신건강 치료 및 관리.\n- 정신건강 상담 및 지원"
}
# 3. PDF 내용 작성
pdf.add_page()
pdf.chapter_title(1, '총칙')
pdf.chapter_body('이 규정은 육군 부서별 업무 분장에 관한 사항을 규정함을 목적으로 한다...\n본 문서는 fpdf2 라이브러리를 사용하여 가상의 데이터로 자동 생성되었습니다.')

# [핵심 변경 사항] enumerate를 사용하여 번호(i)를 자동 생성 (2번부터 시작)
for i, (dept, content) in enumerate(departments.items(), start=2):
    pdf.add_page()
    # 이제 chapter_title 함수가 원하는 인자 2개(번호, 부서명)를 모두 전달합니다.
    pdf.chapter_title(i, dept)
    pdf.chapter_body(content)

# 4. 파일 저장
output_path = 'backend/regulation.pdf'
# output_path = 'regulation.pdf' # backend 폴더가 없다면 이 줄의 주석을 푸세요
pdf.output(output_path)

print(f"PDF 생성이 완료되었습니다: {output_path}")